<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Fileformat ‚Äì marimo-quarto</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../tutorials/markdown_format.html" rel="next">
<link href="../tutorials/layout.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-4e9996e0868c3968a359c7a681947e4e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="module" src="https://cdn.jsdelivr.net/npm/@marimo-team/islands@0.14.8/dist/main.js"></script>
<link href="https://cdn.jsdelivr.net/npm/@marimo-team/islands@0.14.8/dist/style.css" rel="stylesheet" crossorigin="anonymous">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Fira+Mono:wght@400;500;700&amp;family=Lora&amp;family=PT+Sans:wght@400;700&amp;display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css" integrity="sha384-wcIxkf4k558AjM3Yz3BBFQUbk/zgIYC2R0QpeeYb+TwlBVMrlgLqwRjRtGZiK7ww" crossorigin="anonymous">
<meta property="og:title" content="Fileformat ‚Äì marimo-quarto">
<meta property="og:description" content="">
<meta property="og:site_name" content="marimo-quarto">
</head><body class="nav-sidebar docked quarto-light"><marimo-filename hidden=""></marimo-filename>






<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../tutorials/index.html">Tutorials</a></li><li class="breadcrumb-item"><a href="../tutorials/fileformat.html">Fileformat</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">marimo-quarto</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">marimo + quarto</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../tutorials/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorials</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Intro</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/dataflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dataflow</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/ui.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ui</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/markdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Markdown</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/layout.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Layout</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/fileformat.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Fileformat</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/markdown_format.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Markdown</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/for_jupyter_users.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">marimo for Jupyter users</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/example-pdf.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PDF example</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#file-format" id="toc-file-format" class="nav-link active" data-scroll-target="#file-format">File Format</a>
  <ul class="collapse">
  <li><a href="#importing-functions-and-classes-from-notebooks" id="toc-importing-functions-and-classes-from-notebooks" class="nav-link" data-scroll-target="#importing-functions-and-classes-from-notebooks">Importing functions and classes from notebooks</a></li>
  <li><a href="#faq" id="toc-faq" class="nav-link" data-scroll-target="#faq">FAQ</a>
  <ul class="collapse">
  <li><a href="#i-want-to-edit-notebooks-in-a-different-editor-what-do-i-need-to-know" id="toc-i-want-to-edit-notebooks-in-a-different-editor-what-do-i-need-to-know" class="nav-link" data-scroll-target="#i-want-to-edit-notebooks-in-a-different-editor-what-do-i-need-to-know">I want to edit notebooks in a different editor, what do I need to know?</a></li>
  <li><a href="#i-want-to-import-functions-from-a-marimo-notebook-what-do-i-need-to-know" id="toc-i-want-to-import-functions-from-a-marimo-notebook-what-do-i-need-to-know" class="nav-link" data-scroll-target="#i-want-to-import-functions-from-a-marimo-notebook-what-do-i-need-to-know">I want to import functions from a marimo notebook, what do I need to know?</a></li>
  <li><a href="#i-want-to-run-pytest-on-marimo-notebooks-what-do-i-need-to-know" id="toc-i-want-to-run-pytest-on-marimo-notebooks-what-do-i-need-to-know" class="nav-link" data-scroll-target="#i-want-to-run-pytest-on-marimo-notebooks-what-do-i-need-to-know">I want to run pytest on marimo notebooks, what do I need to know?</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../tutorials/index.html">Tutorials</a></li><li class="breadcrumb-item"><a href="../tutorials/fileformat.html">Fileformat</a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Fileformat</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<marimo-island data-app-id="main" data-cell-id="Hbol" data-reactive="true">
    <marimo-cell-output>
    <span></span>
    </marimo-cell-output>
    <marimo-cell-code hidden="">import%20dataclasses%0Aimport%20random</marimo-cell-code>
</marimo-island>
<marimo-island data-app-id="main" data-cell-id="MJUe" data-reactive="true">
    <marimo-cell-output>
    <span></span>
    </marimo-cell-output>
    <marimo-cell-code hidden="">import%20marimo%20as%20mo</marimo-cell-code>
</marimo-island>
<section id="file-format" class="level1">
<h1>File Format</h1>
<p>marimo apps are stored as pure Python files.</p>
<p>These files are:</p>
<ul>
<li>ü§ñ legible for both humans and machines</li>
<li>‚úèÔ∏è formattable using your tool of choice</li>
<li>‚ûï easily versioned with git, producing small diffs</li>
<li>üêç usable as Python scripts, with UI elements taking their default values</li>
<li>üß© modular, exposing functions and classes that can be imported from the notebook <!----> ## Example</li>
</ul>
<p>Consider a marimo notebook with the following four cells.</p>
<p>First cell:</p>
<pre class="python3"><code>print(text.value)</code></pre>
<p>Second cell:</p>
<pre class="python3"><code>def say_hello(name="World"):
    return f"Hello, {name}!"</code></pre>
<p>Third cell:</p>
<pre class="python3"><code>text = mo.ui.text(value=say_hello())
text</code></pre>
<p>Fourth cell:</p>
<pre class="python3"><code>import marimo as mo</code></pre>
<!---->
<p>For the above example, marimo would generate the following file contents:</p>
<pre class="python3"><code>import marimo

__generated_with = "0.0.0"
app = marimo.App()

@app.cell
def _(text):
    print(text.value)
    return

@app.function
def say_hello(name="World"):
    return f"Hello, {name}!"

@app.cell
def _(mo):
    text = mo.ui.text(value="Hello, World!")
    text
    return (text,)

@app.cell
def _():
    import marimo as mo
    return mo,

if __name__ == "__main__":
    app.run()</code></pre>
<p>As you can see, this is <em>pure Python</em>. This is part of the reason why marimo‚Äôs generated files are <strong>git-friendly</strong>: small changes made using the marimo editor result in small changes to the file that marimo generates.</p>
<p>Moreover, the cell defining a single pure function <code>say_hello</code> was saved ‚Äútop-level‚Äù in the notebook file, making it possible for you to import it into other Python files or notebooks. <!----> ## Properties</p>
<p>marimo‚Äôs file format was designed to be easy to read and easy to work with, while also serving the needs of the marimo library. You can even edit the generated file‚Äôs cells directly, using your favorite text editor, and format the file with your favorite code formatter.</p>
<p>We explain some properties of marimo‚Äôs file format below.</p>
<marimo-island data-app-id="main" data-cell-id="vblA" data-reactive="true">
            <marimo-cell-output>
            <marimo-accordion data-labels="[&quot;<span class=\&quot;markdown prose dark:prose-invert\&quot;><span class=\&quot;paragraph\&quot;>Cells are functions</span></span>&quot;, &quot;<span class=\&quot;markdown prose dark:prose-invert\&quot;><span class=\&quot;paragraph\&quot;>Cells are stored in presentation order</span></span>&quot;, &quot;<span class=\&quot;markdown prose dark:prose-invert\&quot;><span class=\&quot;paragraph\&quot;>Text formatting is preserved</span></span>&quot;, &quot;<span class=\&quot;markdown prose dark:prose-invert\&quot;><span class=\&quot;paragraph\&quot;>Cell functions can have names</span></span>&quot;, &quot;<span class=\&quot;markdown prose dark:prose-invert\&quot;><span class=\&quot;paragraph\&quot;>No magical tokens</span></span>&quot;, &quot;<span class=\&quot;markdown prose dark:prose-invert\&quot;><span class=\&quot;paragraph\&quot;>Cell signatures automatically maintained</span></span>&quot;, &quot;<span class=\&quot;markdown prose dark:prose-invert\&quot;><span class=\&quot;paragraph\&quot;>The <code>app</code> object</span></span>&quot;, &quot;<span class=\&quot;markdown prose dark:prose-invert\&quot;><span class=\&quot;paragraph\&quot;>Runnable as a script</span></span>&quot;, &quot;<span class=\&quot;markdown prose dark:prose-invert\&quot;><span class=\&quot;paragraph\&quot;>Usable as a module</span></span>&quot;]" data-multiple="false"><div><span class="markdown prose dark:prose-invert"><span class="paragraph">In the <code>dataflow</code> tutorial, we saw that cells are like functions mapping
their refs (the global  variables they uses but don't define) to their
defs (the global variables they define). The generated code makes this
analogy explicit.</span>
<span class="paragraph">In the generated code, there is a function for each cell. The arguments
of  the function are the cell's refs , and its returned variables are
its defs that are referenced by other cells.</span>
<span class="paragraph">For example, the code</span>
<div class="language-python3 codehilite"><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">cell</span>
<span class="k">def</span><span class="w"> </span><span class="nf">_</span><span class="p">(</span><span class="n">mo</span><span class="p">):</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s2">"Hello, World!"</span><span class="p">)</span>
    <span class="n">text</span>
    <span class="k">return</span> <span class="n">text</span><span class="p">,</span>
</code></pre></div>
<span class="paragraph">says that the cell takes as input a variable called <code>mo</code>, and it creates
a global variable called <code>text</code> (that is read by another cell).</span>
<span class="paragraph">In contrast, the code</span>
<div class="language-python3 codehilite"><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">cell</span>
<span class="k">def</span><span class="w"> </span><span class="nf">_</span><span class="p">():</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">marimo</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mo</span>
    <span class="k">return</span> <span class="n">mo</span><span class="p">,</span>
</code></pre></div>
<span class="paragraph">says that the cell doesn't depend on any other cells (its argument list
is  empty), though it does create the variable <code>mo</code> which the previous
cell requires as input.</span></span></div><div><span class="markdown prose dark:prose-invert"><span class="paragraph">Cells are stored in the order that they are arranged in the marimo
editor. So if you want to rearrange
your cells using your favorite text editor, just rearrange the
order that they're defined in the file.</span></span></div><div><span class="markdown prose dark:prose-invert"><span class="paragraph">marimo guarantees that however your source code was
formatted in the marimo editor is exactly how it will be stored in
the generated code. For example, whitespace, line breaks, and so on are
all preserved exactly. This means that you can touch up formatting in
your text editor, either manually or using automated formatters like
Black, and be confident that your changes will be preserved.</span></span></div><div><span class="markdown prose dark:prose-invert"><span class="paragraph">If you want to, you can replace the default names for cell functions
with meaningful ones.</span>
<span class="paragraph">For example, change</span>
<div class="language-python3 codehilite"><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">cell</span>
<span class="k">def</span><span class="w"> </span><span class="nf">_</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="k">return</span>
</code></pre></div>
<span class="paragraph">to</span>
<div class="language-python3 codehilite"><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">cell</span>
<span class="k">def</span><span class="w"> </span><span class="nf">echo</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="k">return</span>
</code></pre></div>
<span class="paragraph">This can make the generated code more readable.</span></span></div><div><span class="markdown prose dark:prose-invert"><span class="paragraph">marimo's generated code is pure Python; no magical syntax.</span></span></div><div><span class="markdown prose dark:prose-invert"><span class="paragraph">If when editing a cell, you forget to include all a cell's refs in its
argument list, or all its defs in its returns, marimo will fix them he next
time you try to open it in the marimo editor. So don't worry that you'll
botch a cell's signature when editing it.</span></span></div><div><span class="markdown prose dark:prose-invert"><span class="paragraph">At the top of the generated code, a variable named <code>app</code> is created.
This object collects the cells into a dataflow graph, using the <code>cell</code>
decorator.</span></span></div><div><span class="markdown prose dark:prose-invert"><span class="paragraph">You can run marimo apps as scripts at the command line,
using Python. This will execute the cells in a
topologically sorted order, just as they would run if you opened the app
with <code>marimo edit</code>.</span>
<span class="paragraph">For example: running our example as a script would print <code>Hello
World!</code> to the console.</span></span></div><div><span class="markdown prose dark:prose-invert"><span class="paragraph">Import top-level functions and classes from the notebook into other
Python files.</span></span></div></marimo-accordion>
            </marimo-cell-output>
            <marimo-cell-code hidden="">mo.accordion(%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%22Cells%20are%20functions%22%3A%20%22%22%22%0A%20%20%20%20In%20the%20%60dataflow%60%20tutorial%2C%20we%20saw%20that%20cells%20are%20like%20functions%20mapping%0A%20%20%20%20their%20refs%20(the%20global%20%20variables%20they%20uses%20but%20don't%20define)%20to%20their%0A%20%20%20%20defs%20(the%20global%20variables%20they%20define).%20The%20generated%20code%20makes%20this%0A%20%20%20%20analogy%20explicit.%0A%0A%20%20%20%20In%20the%20generated%20code%2C%20there%20is%20a%20function%20for%20each%20cell.%20The%20arguments%0A%20%20%20%20of%20%20the%20function%20are%20the%20cell's%20refs%20%2C%20and%20its%20returned%20variables%20are%0A%20%20%20%20its%20defs%20that%20are%20referenced%20by%20other%20cells.%0A%0A%20%20%20%20For%20example%2C%20the%20code%0A%0A%20%20%20%20%60%60%60python3%0A%20%20%20%20%40app.cell%0A%20%20%20%20def%20_(mo)%3A%0A%20%20%20%20%20%20%20%20text%20%3D%20mo.ui.text(value%3D%22Hello%2C%20World!%22)%0A%20%20%20%20%20%20%20%20text%0A%20%20%20%20%20%20%20%20return%20text%2C%0A%20%20%20%20%60%60%60%0A%0A%20%20%20%20says%20that%20the%20cell%20takes%20as%20input%20a%20variable%20called%20%60mo%60%2C%20and%20it%20creates%0A%20%20%20%20a%20global%20variable%20called%20%60text%60%20(that%20is%20read%20by%20another%20cell).%0A%0A%20%20%20%20In%20contrast%2C%20the%20code%0A%0A%20%20%20%20%60%60%60python3%0A%20%20%20%20%40app.cell%0A%20%20%20%20def%20_()%3A%0A%20%20%20%20%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20%20%20%20%20return%20mo%2C%0A%20%20%20%20%60%60%60%0A%0A%20%20%20%20says%20that%20the%20cell%20doesn't%20depend%20on%20any%20other%20cells%20(its%20argument%20list%0A%20%20%20%20is%20%20empty)%2C%20though%20it%20does%20create%20the%20variable%20%60mo%60%20which%20the%20previous%0A%20%20%20%20cell%20requires%20as%20input.%0A%20%20%20%20%22%22%22%2C%0A%20%20%20%20%20%20%20%20%22Cells%20are%20stored%20in%20presentation%20order%22%3A%20%22%22%22%0A%20%20%20%20Cells%20are%20stored%20in%20the%20order%20that%20they%20are%20arranged%20in%20the%20marimo%0A%20%20%20%20editor.%20So%20if%20you%20want%20to%20rearrange%0A%20%20%20%20your%20cells%20using%20your%20favorite%20text%20editor%2C%20just%20rearrange%20the%0A%20%20%20%20order%20that%20they're%20defined%20in%20the%20file.%0A%20%20%20%20%22%22%22%2C%0A%20%20%20%20%20%20%20%20%22Text%20formatting%20is%20preserved%22%3A%20%22%22%22%0A%20%20%20%20marimo%20guarantees%20that%20however%20your%20source%20code%20was%0A%20%20%20%20formatted%20in%20the%20marimo%20editor%20is%20exactly%20how%20it%20will%20be%20stored%20in%0A%20%20%20%20the%20generated%20code.%20For%20example%2C%20whitespace%2C%20line%20breaks%2C%20and%20so%20on%20are%0A%20%20%20%20all%20preserved%20exactly.%20This%20means%20that%20you%20can%20touch%20up%20formatting%20in%0A%20%20%20%20your%20text%20editor%2C%20either%20manually%20or%20using%20automated%20formatters%20like%0A%20%20%20%20Black%2C%20and%20be%20confident%20that%20your%20changes%20will%20be%20preserved.%0A%20%20%20%20%22%22%22%2C%0A%20%20%20%20%20%20%20%20%22Cell%20functions%20can%20have%20names%22%3A%20%22%22%22%0A%20%20%20%20If%20you%20want%20to%2C%20you%20can%20replace%20the%20default%20names%20for%20cell%20functions%0A%20%20%20%20with%20meaningful%20ones.%0A%0A%20%20%20%20For%20example%2C%20change%0A%0A%20%20%20%20%60%60%60python3%0A%20%20%20%20%40app.cell%0A%20%20%20%20def%20_(text)%3A%0A%20%20%20%20%20%20%20%20print(text.value)%0A%20%20%20%20%20%20%20%20return%0A%20%20%20%20%60%60%60%0A%0A%20%20%20%20to%0A%0A%20%20%20%20%60%60%60python3%0A%20%20%20%20%40app.cell%0A%20%20%20%20def%20echo(text)%3A%0A%20%20%20%20%20%20%20%20print(text.value)%0A%20%20%20%20%20%20%20%20return%0A%20%20%20%20%60%60%60%0A%0A%20%20%20%20This%20can%20make%20the%20generated%20code%20more%20readable.%0A%20%20%20%20%22%22%22%2C%0A%20%20%20%20%20%20%20%20%22No%20magical%20tokens%22%3A%20%22%22%22%0A%20%20%20%20marimo's%20generated%20code%20is%20pure%20Python%3B%20no%20magical%20syntax.%0A%20%20%20%20%22%22%22%2C%0A%20%20%20%20%20%20%20%20%22Cell%20signatures%20automatically%20maintained%22%3A%20%22%22%22%0A%20%20%20%20If%20when%20editing%20a%20cell%2C%20you%20forget%20to%20include%20all%20a%20cell's%20refs%20in%20its%0A%20%20%20%20argument%20list%2C%20or%20all%20its%20defs%20in%20its%20returns%2C%20marimo%20will%20fix%20them%20he%20next%0A%20%20%20%20time%20you%20try%20to%20open%20it%20in%20the%20marimo%20editor.%20So%20don't%20worry%20that%20you'll%0A%20%20%20%20botch%20a%20cell's%20signature%20when%20editing%20it.%0A%20%20%20%20%22%22%22%2C%0A%20%20%20%20%20%20%20%20%22The%20%60app%60%20object%22%3A%20%22%22%22%0A%20%20%20%20At%20the%20top%20of%20the%20generated%20code%2C%20a%20variable%20named%20%60app%60%20is%20created.%0A%20%20%20%20This%20object%20collects%20the%20cells%20into%20a%20dataflow%20graph%2C%20using%20the%20%60cell%60%0A%20%20%20%20decorator.%0A%20%20%20%20%22%22%22%2C%0A%20%20%20%20%20%20%20%20%22Runnable%20as%20a%20script%22%3A%20%22%22%22%0A%20%20%20%20You%20can%20run%20marimo%20apps%20as%20scripts%20at%20the%20command%20line%2C%0A%20%20%20%20using%20Python.%20This%20will%20execute%20the%20cells%20in%20a%0A%20%20%20%20topologically%20sorted%20order%2C%20just%20as%20they%20would%20run%20if%20you%20opened%20the%20app%0A%20%20%20%20with%20%60marimo%20edit%60.%0A%0A%20%20%20%20For%20example%3A%20running%20our%20example%20as%20a%20script%20would%20print%20%60Hello%0A%20%20%20%20World!%60%20to%20the%20console.%0A%20%20%20%20%22%22%22%2C%0A%20%20%20%20%20%20%20%20%22%22%22Usable%20as%20a%20module%22%22%22%3A%20%22%22%22%0A%20%20%20%20Import%20top-level%20functions%20and%20classes%20from%20the%20notebook%20into%20other%0A%20%20%20%20Python%20files.%0A%20%20%20%20%22%22%22%2C%0A%20%20%20%20%7D%0A)</marimo-cell-code>
        </marimo-island>
<section id="importing-functions-and-classes-from-notebooks" class="level2">
<h2 class="anchored" data-anchor-id="importing-functions-and-classes-from-notebooks">Importing functions and classes from notebooks</h2>
<p>The details of marimo‚Äôs file format are important if you want to import functions and classes defined in your notebook into other Python modules. If you don‚Äôt intend to do so, you can skip this section. <!----> ### Declaring imports used by functions and classes</p>
<p>marimo can serialize functions and classes into the top-level of a file, so you can import them with regular Python syntax:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> my_notebook <span class="im">import</span> my_function</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In particular, if a cell defines just a single function or class, and if that function or class is pure save for references to variables defined in a special <strong>setup cell</strong>, it will be serialized top-level.</p>
<p><strong>Setup cell.</strong> Notebooks can optionally include a setup cell that imports modules, written in the file as:</p>
<!-- note this setup cell is hardcoded in the playground example -->
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> app.setup:</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> marimo <span class="im">as</span> mo</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> dataclasses</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Modules imported in a setup cell can be used in ‚Äútop-level‚Äù functions or classes. You can add the setup cell from the general menu of the editor under: ::lucide:diamond-plus:: Add setup cell. <!----> ### Functions and classes</p>
<p>Notebook files expose functions and classes that depend only on variables defined in the setup cell (or on other such functions or classes). For example, the following cell:</p>
<marimo-island data-app-id="main" data-cell-id="bkHC" data-reactive="true">
    <marimo-cell-output>
    <span></span>
    </marimo-cell-output>
    <marimo-cell-code hidden="">def%20roll_die()%3A%0A%20%20%20%20%22%22%22%0A%20%20%20%20A%20reusable%20function.%0A%0A%20%20%20%20Notice%20the%20indicator%20in%20the%20bottom%20right%20of%20the%20cell.%0A%20%20%20%20%22%22%22%0A%20%20%20%20return%20random.randint(1%2C%207)</marimo-cell-code>
</marimo-island>
<p>‚Ä¶ is saved in the notebook file as</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="at">@app.function</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> roll_die():</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">    A reusable function.</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Notice the indicator in the bottom right of the cell.</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">    '''</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> random.randint(<span class="dv">1</span>, <span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Making it importable as</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> my_notebook <span class="im">import</span> roll_die</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<!---->
<p>Standalone classes are also exposed:</p>
<marimo-island data-app-id="main" data-cell-id="lEQa" data-reactive="true">
    <marimo-cell-output>
    <span></span>
    </marimo-cell-output>
    <marimo-cell-code hidden="">%40dataclasses.dataclass%0Aclass%20SimulationExample%3A%0A%20%20%20%20n_rolls%3A%20int%0A%0A%20%20%20%20def%20simulate(self)%20-%3E%20list%5Bint%5D%3A%0A%20%20%20%20%20%20%20%20return%20%5Broll_die()%20for%20_%20in%20range(self.n_rolls)%5D</marimo-cell-code>
</marimo-island>
<p>This class is saved in the file as</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="at">@app.class_definition</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclasses.dataclass</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SimulationExample:</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    n_rolls: <span class="bu">int</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> simulate(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">list</span>[<span class="bu">int</span>]:</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [roll_die() <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.n_rolls)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<!---->
<p>/// attention | Heads up ///</p>
<p>Not all standalone functions will be exposed in the module. If your function depends on variables that are defined in other cells, then it won‚Äôt be exposed top-level.</p>
<p>For example, this function will not be exposed:</p>
<marimo-island data-app-id="main" data-cell-id="PKri" data-reactive="true">
    <marimo-cell-output>
    <span></span>
    </marimo-cell-output>
    <marimo-cell-code hidden="">variable%20%3D%20123</marimo-cell-code>
</marimo-island>
<marimo-island data-app-id="main" data-cell-id="Xref" data-reactive="true">
    <marimo-cell-output>
    <span></span>
    </marimo-cell-output>
    <marimo-cell-code hidden="">def%20not_a_top_level_function()%3A%0A%20%20%20%20%22%22%22%0A%20%20%20%20This%20function%20depends%20on%20a%20variable%20declared%20in%20another%20cell.%0A%0A%20%20%20%20As%20a%20result%20this%20function%20isn't%20exposed%20in%20the%20file%20%E2%80%94%20and%20the%20tooltip%20in%20the%0A%20%20%20%20bottom-right%20corner%20indicates%20this.%0A%20%20%20%20%22%22%22%0A%20%20%20%20return%20variable</marimo-cell-code>
</marimo-island>
</section>
<section id="faq" class="level2">
<h2 class="anchored" data-anchor-id="faq">FAQ</h2>
<section id="i-want-to-edit-notebooks-in-a-different-editor-what-do-i-need-to-know" class="level3">
<h3 class="anchored" data-anchor-id="i-want-to-edit-notebooks-in-a-different-editor-what-do-i-need-to-know">I want to edit notebooks in a different editor, what do I need to know?</h3>
<p>See the docs on <a href="https://docs.marimo.io/guides/editor_features/watching/">using your own editor</a>.</p>
</section>
<section id="i-want-to-import-functions-from-a-marimo-notebook-what-do-i-need-to-know" class="level3">
<h3 class="anchored" data-anchor-id="i-want-to-import-functions-from-a-marimo-notebook-what-do-i-need-to-know">I want to import functions from a marimo notebook, what do I need to know?</h3>
<p>See the docs on <a href="https://links.marimo.app/reusable-functions">reusable functions and classes</a>.</p>
</section>
<section id="i-want-to-run-pytest-on-marimo-notebooks-what-do-i-need-to-know" class="level3">
<h3 class="anchored" data-anchor-id="i-want-to-run-pytest-on-marimo-notebooks-what-do-i-need-to-know">I want to run pytest on marimo notebooks, what do I need to know?</h3>
<p>See the docs on <a href="https://docs.marimo.io/guides/testing/">testing</a>. <!----> ## This notebook‚Äôs source code</p>
<p>The source code of this notebook is shown below:</p>
<marimo-island data-app-id="main" data-cell-id="SFPL" data-reactive="true">
    <marimo-cell-output>
    <span></span>
    </marimo-cell-output>
    <marimo-cell-code hidden="">with%20open(__file__%2C%20%22r%22%2C%20encoding%3D%22utf-8%22)%20as%20f%3A%0A%20%20%20%20contents%20%3D%20f.read()</marimo-cell-code>
</marimo-island>
<marimo-island data-app-id="main" data-cell-id="BYtC" data-reactive="true">
    <marimo-cell-output>
    <marimo-ui-element object-id="BYtC-0" random-id="6f37ef0a-f5d6-7dd7-de6d-76318fdf7f89"><marimo-code-editor data-initial-value="&quot;#!/usr/bin/env python3\n\nimport asyncio\nimport json\nimport os\nimport re\nimport sys\nfrom typing import Any, Callable, Optional\n\n# Native to python\nfrom xml.etree.ElementTree import Element\n\nimport marimo\nfrom marimo import MarimoIslandGenerator\n\ntry:\n    from marimo._ast.app import App\n    from marimo._convert.markdown.markdown import (\n        MARIMO_MD,\n        MarimoMdParser as MarimoParser,\n        SafeWrap as SafeWrapGeneric,\n    )\n\n    SafeWrap = SafeWrapGeneric[App]\nexcept ImportError:\n    # Fallback for marimo < 0.13.16\n    from marimo._cli.convert.markdown import (  # type: ignore[import, no-redef]\n        MARIMO_MD,\n        MarimoParser,\n        SafeWrap,\n    )\n\nfrom marimo._islands import MarimoIslandStub\n\n__version__ = \&quot;0.0.1\&quot;\n\n# See https://quarto.org/docs/computations/execution-options.html\ndefault_config = {\n    \&quot;eval\&quot;: True,\n    \&quot;echo\&quot;: False,\n    \&quot;output\&quot;: True,\n    \&quot;warning\&quot;: True,\n    \&quot;error\&quot;: True,\n    \&quot;include\&quot;: True,\n    # Particular to marimo\n    \&quot;editor\&quot;: False,\n}\n\n\ndef extract_and_strip_quarto_config(block: str) -> tuple[dict[str, Any], str]:\n    pattern = r\&quot;^\\s*\\#\\|\\s*(.*?)\\s*:\\s*(.*?)(?=\\n|\\Z)\&quot;\n    config: dict[str, Any] = {}\n    lines = block.split(\&quot;\\n\&quot;)\n    if not lines:\n        return config, block\n\n    split_index = 0\n    for i, line in enumerate(lines):\n        split_index = i\n        line = line.strip()\n        if not line:\n            continue\n        source_match = re.search(pattern, line)\n        if not source_match:\n            break\n        key, value = source_match.groups()\n        config[key] = json.loads(value)\n    return config, \&quot;\\n\&quot;.join(lines[split_index:])\n\n\ndef get_mime_render(\n    global_options: dict[str, Any],\n    stub: Optional[MarimoIslandStub],\n    config: dict[str, bool],\n    mime_sensitive: bool,\n) -> dict[str, Any]:\n    # Local supersede global supersedes default options\n    config = {**global_options, **config}\n    if not config[\&quot;include\&quot;] or stub is None:\n        return {\&quot;type\&quot;: \&quot;html\&quot;, \&quot;value\&quot;: \&quot;\&quot;}\n\n    output = stub.output\n    render_options = {\n        \&quot;display_code\&quot;: config[\&quot;echo\&quot;],\n        \&quot;reactive\&quot;: config[\&quot;eval\&quot;] and not mime_sensitive,\n        \&quot;code\&quot;: stub.code,\n    }\n\n    if output:\n        mimetype = output.mimetype\n        if config[\&quot;output\&quot;] and mime_sensitive:\n            if mimetype.startswith(\&quot;image\&quot;):\n                return {\&quot;type\&quot;: \&quot;figure\&quot;, \&quot;value\&quot;: f\&quot;{output.data}\&quot;, **render_options}\n            if mimetype.startswith(\&quot;text/plain\&quot;) or mimetype.startswith(\n                \&quot;text/markdown\&quot;\n            ):\n                return {\&quot;type\&quot;: \&quot;para\&quot;, \&quot;value\&quot;: f\&quot;{output.data}\&quot;, **render_options}\n            if mimetype == \&quot;application/vnd.marimo+error\&quot;:\n                if config[\&quot;error\&quot;]:\n                    return {\n                        \&quot;type\&quot;: \&quot;blockquote\&quot;,\n                        \&quot;value\&quot;: f\&quot;{output.data}\&quot;,\n                        **render_options,\n                    }\n                # Suppress errors otherwise\n                return {\&quot;type\&quot;: \&quot;para\&quot;, \&quot;value\&quot;: \&quot;\&quot;, **render_options}\n\n        elif mimetype == \&quot;application/vnd.marimo+error\&quot;:\n            if config[\&quot;warning\&quot;]:\n                sys.stderr.write(\n                    \&quot;Warning: Only the `disabled` codeblock attribute is utilized\&quot;\n                    \&quot; for pandoc export. Be sure to set desired code attributes \&quot;\n                    \&quot;in quarto form.\&quot;\n                )\n            if not config[\&quot;error\&quot;]:\n                return {\&quot;type\&quot;: \&quot;html\&quot;, \&quot;value\&quot;: \&quot;\&quot;}\n\n    # HTML as catch all default\n    return {\n        \&quot;type\&quot;: \&quot;html\&quot;,\n        \&quot;value\&quot;: stub.render(\n            display_code=config[\&quot;echo\&quot;],\n            display_output=config[\&quot;output\&quot;],\n            is_reactive=bool(render_options[\&quot;reactive\&quot;]),\n            as_raw=mime_sensitive,\n        ),\n        **render_options,\n    }\n\n\ndef app_config_from_root(root: Element) -> dict[str, Any]:\n    # Extract meta data from root attributes.\n    config_keys = {\&quot;title\&quot;: \&quot;app_title\&quot;, \&quot;marimo-layout\&quot;: \&quot;layout_file\&quot;}\n    config = {\n        config_keys[key]: value for key, value in root.items() if key in config_keys\n    }\n    # Try to pass on other attributes as is\n    config.update({k: v for k, v in root.items() if k not in config_keys})\n    # Remove values particular to markdown saves.\n    config.pop(\&quot;marimo-version\&quot;, None)\n    return config\n\n\ndef build_export_with_mime_context(\n    mime_sensitive: bool,\n) -> Callable[[Element], SafeWrap]:\n    def tree_to_pandoc_export(root: Element) -> SafeWrap:\n        global_options = {**default_config, **app_config_from_root(root)}\n        app = MarimoIslandGenerator()\n\n        has_attrs: bool = False\n        stubs: list[tuple[dict[str, bool], Optional[MarimoIslandStub]]] = []\n        for child in root:\n            # only process code cells\n            if child.tag == MARIMO_MD:\n                continue\n            # We only care about the disabled attribute.\n            if child.attrib.get(\&quot;disabled\&quot;) == \&quot;true\&quot;:\n                # Don't even add to generator\n                stubs.append(({\&quot;include\&quot;: False}, None))\n                continue\n            # Check to see id attrs are defined on the tag\n            has_attrs = has_attrs | bool(child.attrib.items())\n\n            code = str(child.text)\n            config, code = extract_and_strip_quarto_config(code)\n\n            try:\n                stub = app.add_code(\n                    code,\n                    is_raw=True,\n                )\n            except Exception:\n                stubs.append((config, None))\n                continue\n\n            assert isinstance(stub, MarimoIslandStub), \&quot;Unexpected error, please report\&quot;\n\n            stubs.append(\n                (\n                    config,\n                    stub,\n                )\n            )\n\n        if has_attrs and global_options.get(\&quot;warning\&quot;, True):\n            pass\n\n        _ = asyncio.run(app.build())\n        dev_server = os.environ.get(\&quot;QUARTO_MARIMO_DEBUG_ENDPOINT\&quot;, False)\n        version_override = os.environ.get(\&quot;QUARTO_MARIMO_VERSION\&quot;, marimo.__version__)\n        header = app.render_head(\n            _development_url=dev_server, version_override=version_override\n        )\n\n        return SafeWrap(\n            {\n                \&quot;header\&quot;: header,\n                \&quot;outputs\&quot;: [\n                    get_mime_render(global_options, stub, config, mime_sensitive)\n                    for config, stub in stubs\n                ],\n                \&quot;count\&quot;: len(stubs),\n            }  # type: ignore[arg-type]\n        )\n\n    return tree_to_pandoc_export\n\n\nclass MarimoPandocParser(MarimoParser):\n    \&quot;\&quot;\&quot;Parses Markdown to marimo notebook string.\&quot;\&quot;\&quot;\n\n    # TODO: Could upstream generic for keys- but this is fine.\n    output_formats = {  # type: ignore[assignment, misc]\n        \&quot;marimo-pandoc-export\&quot;: build_export_with_mime_context(mime_sensitive=False),  # type: ignore[dict-item]\n        \&quot;marimo-pandoc-export-with-mime\&quot;: build_export_with_mime_context(\n            mime_sensitive=True\n        ),  # type: ignore[dict-item]\n    }\n\n\ndef convert_from_md_to_pandoc_export(text: str, mime_sensitive: bool) -> dict[str, Any]:\n    if not text:\n        return {\&quot;header\&quot;: \&quot;\&quot;, \&quot;outputs\&quot;: []}\n    if mime_sensitive:\n        parser = MarimoPandocParser(output_format=\&quot;marimo-pandoc-export-with-mime\&quot;)  # type: ignore[arg-type]\n    else:\n        parser = MarimoPandocParser(output_format=\&quot;marimo-pandoc-export\&quot;)  # type: ignore[arg-type]\n    return parser.convert(text)  # type: ignore[arg-type, return-value]\n\n\nif __name__ == \&quot;__main__\&quot;:\n    assert len(sys.argv) == 3, f\&quot;Unexpected call format got {sys.argv}\&quot;\n    _, reference_file, mime_sensitive = sys.argv\n\n    file = sys.stdin.read()\n    if not file:\n        with open(reference_file) as f:\n            file = f.read()\n    no_js = mime_sensitive.lower() == \&quot;yes\&quot;\n    os.environ[\&quot;MARIMO_NO_JS\&quot;] = str(no_js).lower()\n\n    conversion = convert_from_md_to_pandoc_export(file, no_js)\n    sys.stdout.write(json.dumps(conversion))\n&quot;" data-label="null" data-language="&quot;python&quot;" data-placeholder="&quot;&quot;" data-disabled="false" data-show-copy-button="true" data-debounce="false"></marimo-code-editor></marimo-ui-element>
    </marimo-cell-output>
    <marimo-cell-code hidden="">mo.ui.code_editor(contents)</marimo-cell-code>
</marimo-island>


<!-- -->

</section>
</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../tutorials/layout.html" class="pagination-link" aria-label="Layout">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Layout</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../tutorials/markdown_format.html" class="pagination-link" aria-label="Markdown">
        <span class="nav-page-text">Markdown</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb11" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> Fileformat</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="an">marimo-version:</span><span class="co"> 0.13.2</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="an">header:</span><span class="co"> |-</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">  # Copyright 2025 Marimo. All rights reserved</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="an">filters:</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">- marimo-team/marimo</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="in">```python {.marimo name="setup"}</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> dataclasses</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="in">```python {.marimo}</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> marimo <span class="im">as</span> mo</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="fu"># File Format</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>marimo apps are stored as pure Python files.</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>These files are:</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>ü§ñ legible for both humans and machines</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>‚úèÔ∏è formattable using your tool of choice</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>‚ûï easily versioned with git, producing small diffs</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>üêç usable as Python  scripts, with UI  elements taking their default values</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>üß© modular, exposing functions and classes that can be imported from the notebook</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!----&gt;</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a><span class="fu">## Example</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>Consider a marimo notebook with the following four cells.</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>First cell:</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a><span class="in">```python3</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(text.value)</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>Second cell:</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a><span class="in">```python3</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> say_hello(name<span class="op">=</span><span class="st">"World"</span>):</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="ss">f"Hello, </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">!"</span></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>Third cell:</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a><span class="in">```python3</span></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>text <span class="op">=</span> mo.ui.text(value<span class="op">=</span>say_hello())</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>text</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>Fourth cell:</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a><span class="in">```python3</span></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> marimo <span class="im">as</span> mo</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!----&gt;</span></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>For the above example, marimo would generate the following file</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>contents:</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a><span class="in">```python3</span></span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> marimo</span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>__generated_with <span class="op">=</span> <span class="st">"0.0.0"</span></span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>app <span class="op">=</span> marimo.App()</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a><span class="at">@app.cell</span></span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> _(text):</span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(text.value)</span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span></span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a><span class="at">@app.function</span></span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> say_hello(name<span class="op">=</span><span class="st">"World"</span>):</span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="ss">f"Hello, </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">!"</span></span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a><span class="at">@app.cell</span></span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> _(mo):</span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> mo.ui.text(value<span class="op">=</span><span class="st">"Hello, World!"</span>)</span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>    text</span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (text,)</span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a><span class="at">@app.cell</span></span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> _():</span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> marimo <span class="im">as</span> mo</span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mo,</span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>    app.run()</span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a>As you can see, this is _pure Python_. This is part of the reason why</span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a>marimo's generated files are **git-friendly**: small changes made using</span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a>the marimo editor result in small changes to the file that marimo</span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true" tabindex="-1"></a>generates.</span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true" tabindex="-1"></a>Moreover, the cell defining a single pure function <span class="in">`say_hello`</span> was saved "top-level" in the notebook file, making it possible for you to import it into other Python files or notebooks.</span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!----&gt;</span></span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true" tabindex="-1"></a><span class="fu">## Properties</span></span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true" tabindex="-1"></a>marimo's file format was designed to be easy to read and easy</span>
<span id="cb11-100"><a href="#cb11-100" aria-hidden="true" tabindex="-1"></a>to work with, while also serving the needs of the marimo library. You can</span>
<span id="cb11-101"><a href="#cb11-101" aria-hidden="true" tabindex="-1"></a>even edit the generated file's cells directly, using your favorite text</span>
<span id="cb11-102"><a href="#cb11-102" aria-hidden="true" tabindex="-1"></a>editor, and format the file with your favorite code formatter.</span>
<span id="cb11-103"><a href="#cb11-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-104"><a href="#cb11-104" aria-hidden="true" tabindex="-1"></a>We explain some properties of marimo's file format below.</span>
<span id="cb11-105"><a href="#cb11-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-106"><a href="#cb11-106" aria-hidden="true" tabindex="-1"></a><span class="in">````python {.marimo hide_code="true"}</span></span>
<span id="cb11-107"><a href="#cb11-107" aria-hidden="true" tabindex="-1"></a>mo.accordion(</span>
<span id="cb11-108"><a href="#cb11-108" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb11-109"><a href="#cb11-109" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Cells are functions"</span>: <span class="st">"""</span></span>
<span id="cb11-110"><a href="#cb11-110" aria-hidden="true" tabindex="-1"></a><span class="st">    In the `dataflow` tutorial, we saw that cells are like functions mapping</span></span>
<span id="cb11-111"><a href="#cb11-111" aria-hidden="true" tabindex="-1"></a><span class="st">    their refs (the global  variables they uses but don't define) to their</span></span>
<span id="cb11-112"><a href="#cb11-112" aria-hidden="true" tabindex="-1"></a><span class="st">    defs (the global variables they define). The generated code makes this</span></span>
<span id="cb11-113"><a href="#cb11-113" aria-hidden="true" tabindex="-1"></a><span class="st">    analogy explicit.</span></span>
<span id="cb11-114"><a href="#cb11-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-115"><a href="#cb11-115" aria-hidden="true" tabindex="-1"></a><span class="st">    In the generated code, there is a function for each cell. The arguments</span></span>
<span id="cb11-116"><a href="#cb11-116" aria-hidden="true" tabindex="-1"></a><span class="st">    of  the function are the cell's refs , and its returned variables are</span></span>
<span id="cb11-117"><a href="#cb11-117" aria-hidden="true" tabindex="-1"></a><span class="st">    its defs that are referenced by other cells.</span></span>
<span id="cb11-118"><a href="#cb11-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-119"><a href="#cb11-119" aria-hidden="true" tabindex="-1"></a><span class="st">    For example, the code</span></span>
<span id="cb11-120"><a href="#cb11-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-121"><a href="#cb11-121" aria-hidden="true" tabindex="-1"></a><span class="st">    ```python3</span></span>
<span id="cb11-122"><a href="#cb11-122" aria-hidden="true" tabindex="-1"></a><span class="st">    @app.cell</span></span>
<span id="cb11-123"><a href="#cb11-123" aria-hidden="true" tabindex="-1"></a><span class="st">    def _(mo):</span></span>
<span id="cb11-124"><a href="#cb11-124" aria-hidden="true" tabindex="-1"></a><span class="st">        text = mo.ui.text(value="Hello, World!")</span></span>
<span id="cb11-125"><a href="#cb11-125" aria-hidden="true" tabindex="-1"></a><span class="st">        text</span></span>
<span id="cb11-126"><a href="#cb11-126" aria-hidden="true" tabindex="-1"></a><span class="st">        return text,</span></span>
<span id="cb11-127"><a href="#cb11-127" aria-hidden="true" tabindex="-1"></a><span class="st">    ```</span></span>
<span id="cb11-128"><a href="#cb11-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-129"><a href="#cb11-129" aria-hidden="true" tabindex="-1"></a><span class="st">    says that the cell takes as input a variable called `mo`, and it creates</span></span>
<span id="cb11-130"><a href="#cb11-130" aria-hidden="true" tabindex="-1"></a><span class="st">    a global variable called `text` (that is read by another cell).</span></span>
<span id="cb11-131"><a href="#cb11-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-132"><a href="#cb11-132" aria-hidden="true" tabindex="-1"></a><span class="st">    In contrast, the code</span></span>
<span id="cb11-133"><a href="#cb11-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-134"><a href="#cb11-134" aria-hidden="true" tabindex="-1"></a><span class="st">    ```python3</span></span>
<span id="cb11-135"><a href="#cb11-135" aria-hidden="true" tabindex="-1"></a><span class="st">    @app.cell</span></span>
<span id="cb11-136"><a href="#cb11-136" aria-hidden="true" tabindex="-1"></a><span class="st">    def _():</span></span>
<span id="cb11-137"><a href="#cb11-137" aria-hidden="true" tabindex="-1"></a><span class="st">        import marimo as mo</span></span>
<span id="cb11-138"><a href="#cb11-138" aria-hidden="true" tabindex="-1"></a><span class="st">        return mo,</span></span>
<span id="cb11-139"><a href="#cb11-139" aria-hidden="true" tabindex="-1"></a><span class="st">    ```</span></span>
<span id="cb11-140"><a href="#cb11-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-141"><a href="#cb11-141" aria-hidden="true" tabindex="-1"></a><span class="st">    says that the cell doesn't depend on any other cells (its argument list</span></span>
<span id="cb11-142"><a href="#cb11-142" aria-hidden="true" tabindex="-1"></a><span class="st">    is  empty), though it does create the variable `mo` which the previous</span></span>
<span id="cb11-143"><a href="#cb11-143" aria-hidden="true" tabindex="-1"></a><span class="st">    cell requires as input.</span></span>
<span id="cb11-144"><a href="#cb11-144" aria-hidden="true" tabindex="-1"></a><span class="st">    """</span>,</span>
<span id="cb11-145"><a href="#cb11-145" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Cells are stored in presentation order"</span>: <span class="st">"""</span></span>
<span id="cb11-146"><a href="#cb11-146" aria-hidden="true" tabindex="-1"></a><span class="st">    Cells are stored in the order that they are arranged in the marimo</span></span>
<span id="cb11-147"><a href="#cb11-147" aria-hidden="true" tabindex="-1"></a><span class="st">    editor. So if you want to rearrange</span></span>
<span id="cb11-148"><a href="#cb11-148" aria-hidden="true" tabindex="-1"></a><span class="st">    your cells using your favorite text editor, just rearrange the</span></span>
<span id="cb11-149"><a href="#cb11-149" aria-hidden="true" tabindex="-1"></a><span class="st">    order that they're defined in the file.</span></span>
<span id="cb11-150"><a href="#cb11-150" aria-hidden="true" tabindex="-1"></a><span class="st">    """</span>,</span>
<span id="cb11-151"><a href="#cb11-151" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Text formatting is preserved"</span>: <span class="st">"""</span></span>
<span id="cb11-152"><a href="#cb11-152" aria-hidden="true" tabindex="-1"></a><span class="st">    marimo guarantees that however your source code was</span></span>
<span id="cb11-153"><a href="#cb11-153" aria-hidden="true" tabindex="-1"></a><span class="st">    formatted in the marimo editor is exactly how it will be stored in</span></span>
<span id="cb11-154"><a href="#cb11-154" aria-hidden="true" tabindex="-1"></a><span class="st">    the generated code. For example, whitespace, line breaks, and so on are</span></span>
<span id="cb11-155"><a href="#cb11-155" aria-hidden="true" tabindex="-1"></a><span class="st">    all preserved exactly. This means that you can touch up formatting in</span></span>
<span id="cb11-156"><a href="#cb11-156" aria-hidden="true" tabindex="-1"></a><span class="st">    your text editor, either manually or using automated formatters like</span></span>
<span id="cb11-157"><a href="#cb11-157" aria-hidden="true" tabindex="-1"></a><span class="st">    Black, and be confident that your changes will be preserved.</span></span>
<span id="cb11-158"><a href="#cb11-158" aria-hidden="true" tabindex="-1"></a><span class="st">    """</span>,</span>
<span id="cb11-159"><a href="#cb11-159" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Cell functions can have names"</span>: <span class="st">"""</span></span>
<span id="cb11-160"><a href="#cb11-160" aria-hidden="true" tabindex="-1"></a><span class="st">    If you want to, you can replace the default names for cell functions</span></span>
<span id="cb11-161"><a href="#cb11-161" aria-hidden="true" tabindex="-1"></a><span class="st">    with meaningful ones.</span></span>
<span id="cb11-162"><a href="#cb11-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-163"><a href="#cb11-163" aria-hidden="true" tabindex="-1"></a><span class="st">    For example, change</span></span>
<span id="cb11-164"><a href="#cb11-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-165"><a href="#cb11-165" aria-hidden="true" tabindex="-1"></a><span class="st">    ```python3</span></span>
<span id="cb11-166"><a href="#cb11-166" aria-hidden="true" tabindex="-1"></a><span class="st">    @app.cell</span></span>
<span id="cb11-167"><a href="#cb11-167" aria-hidden="true" tabindex="-1"></a><span class="st">    def _(text):</span></span>
<span id="cb11-168"><a href="#cb11-168" aria-hidden="true" tabindex="-1"></a><span class="st">        print(text.value)</span></span>
<span id="cb11-169"><a href="#cb11-169" aria-hidden="true" tabindex="-1"></a><span class="st">        return</span></span>
<span id="cb11-170"><a href="#cb11-170" aria-hidden="true" tabindex="-1"></a><span class="st">    ```</span></span>
<span id="cb11-171"><a href="#cb11-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-172"><a href="#cb11-172" aria-hidden="true" tabindex="-1"></a><span class="st">    to</span></span>
<span id="cb11-173"><a href="#cb11-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-174"><a href="#cb11-174" aria-hidden="true" tabindex="-1"></a><span class="st">    ```python3</span></span>
<span id="cb11-175"><a href="#cb11-175" aria-hidden="true" tabindex="-1"></a><span class="st">    @app.cell</span></span>
<span id="cb11-176"><a href="#cb11-176" aria-hidden="true" tabindex="-1"></a><span class="st">    def echo(text):</span></span>
<span id="cb11-177"><a href="#cb11-177" aria-hidden="true" tabindex="-1"></a><span class="st">        print(text.value)</span></span>
<span id="cb11-178"><a href="#cb11-178" aria-hidden="true" tabindex="-1"></a><span class="st">        return</span></span>
<span id="cb11-179"><a href="#cb11-179" aria-hidden="true" tabindex="-1"></a><span class="st">    ```</span></span>
<span id="cb11-180"><a href="#cb11-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-181"><a href="#cb11-181" aria-hidden="true" tabindex="-1"></a><span class="st">    This can make the generated code more readable.</span></span>
<span id="cb11-182"><a href="#cb11-182" aria-hidden="true" tabindex="-1"></a><span class="st">    """</span>,</span>
<span id="cb11-183"><a href="#cb11-183" aria-hidden="true" tabindex="-1"></a>        <span class="st">"No magical tokens"</span>: <span class="st">"""</span></span>
<span id="cb11-184"><a href="#cb11-184" aria-hidden="true" tabindex="-1"></a><span class="st">    marimo's generated code is pure Python; no magical syntax.</span></span>
<span id="cb11-185"><a href="#cb11-185" aria-hidden="true" tabindex="-1"></a><span class="st">    """</span>,</span>
<span id="cb11-186"><a href="#cb11-186" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Cell signatures automatically maintained"</span>: <span class="st">"""</span></span>
<span id="cb11-187"><a href="#cb11-187" aria-hidden="true" tabindex="-1"></a><span class="st">    If when editing a cell, you forget to include all a cell's refs in its</span></span>
<span id="cb11-188"><a href="#cb11-188" aria-hidden="true" tabindex="-1"></a><span class="st">    argument list, or all its defs in its returns, marimo will fix them he next</span></span>
<span id="cb11-189"><a href="#cb11-189" aria-hidden="true" tabindex="-1"></a><span class="st">    time you try to open it in the marimo editor. So don't worry that you'll</span></span>
<span id="cb11-190"><a href="#cb11-190" aria-hidden="true" tabindex="-1"></a><span class="st">    botch a cell's signature when editing it.</span></span>
<span id="cb11-191"><a href="#cb11-191" aria-hidden="true" tabindex="-1"></a><span class="st">    """</span>,</span>
<span id="cb11-192"><a href="#cb11-192" aria-hidden="true" tabindex="-1"></a>        <span class="st">"The `app` object"</span>: <span class="st">"""</span></span>
<span id="cb11-193"><a href="#cb11-193" aria-hidden="true" tabindex="-1"></a><span class="st">    At the top of the generated code, a variable named `app` is created.</span></span>
<span id="cb11-194"><a href="#cb11-194" aria-hidden="true" tabindex="-1"></a><span class="st">    This object collects the cells into a dataflow graph, using the `cell`</span></span>
<span id="cb11-195"><a href="#cb11-195" aria-hidden="true" tabindex="-1"></a><span class="st">    decorator.</span></span>
<span id="cb11-196"><a href="#cb11-196" aria-hidden="true" tabindex="-1"></a><span class="st">    """</span>,</span>
<span id="cb11-197"><a href="#cb11-197" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Runnable as a script"</span>: <span class="st">"""</span></span>
<span id="cb11-198"><a href="#cb11-198" aria-hidden="true" tabindex="-1"></a><span class="st">    You can run marimo apps as scripts at the command line,</span></span>
<span id="cb11-199"><a href="#cb11-199" aria-hidden="true" tabindex="-1"></a><span class="st">    using Python. This will execute the cells in a</span></span>
<span id="cb11-200"><a href="#cb11-200" aria-hidden="true" tabindex="-1"></a><span class="st">    topologically sorted order, just as they would run if you opened the app</span></span>
<span id="cb11-201"><a href="#cb11-201" aria-hidden="true" tabindex="-1"></a><span class="st">    with `marimo edit`.</span></span>
<span id="cb11-202"><a href="#cb11-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-203"><a href="#cb11-203" aria-hidden="true" tabindex="-1"></a><span class="st">    For example: running our example as a script would print `Hello</span></span>
<span id="cb11-204"><a href="#cb11-204" aria-hidden="true" tabindex="-1"></a><span class="st">    World!` to the console.</span></span>
<span id="cb11-205"><a href="#cb11-205" aria-hidden="true" tabindex="-1"></a><span class="st">    """</span>,</span>
<span id="cb11-206"><a href="#cb11-206" aria-hidden="true" tabindex="-1"></a>        <span class="st">"""Usable as a module"""</span>: <span class="st">"""</span></span>
<span id="cb11-207"><a href="#cb11-207" aria-hidden="true" tabindex="-1"></a><span class="st">    Import top-level functions and classes from the notebook into other</span></span>
<span id="cb11-208"><a href="#cb11-208" aria-hidden="true" tabindex="-1"></a><span class="st">    Python files.</span></span>
<span id="cb11-209"><a href="#cb11-209" aria-hidden="true" tabindex="-1"></a><span class="st">    """</span>,</span>
<span id="cb11-210"><a href="#cb11-210" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-211"><a href="#cb11-211" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-212"><a href="#cb11-212" aria-hidden="true" tabindex="-1"></a><span class="in">````</span></span>
<span id="cb11-213"><a href="#cb11-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-214"><a href="#cb11-214" aria-hidden="true" tabindex="-1"></a><span class="fu">## Importing functions and classes from notebooks</span></span>
<span id="cb11-215"><a href="#cb11-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-216"><a href="#cb11-216" aria-hidden="true" tabindex="-1"></a>The details of marimo's file format are important if you want to import</span>
<span id="cb11-217"><a href="#cb11-217" aria-hidden="true" tabindex="-1"></a>functions and classes defined in your notebook into other Python modules. If you</span>
<span id="cb11-218"><a href="#cb11-218" aria-hidden="true" tabindex="-1"></a>don't intend to do so, you can skip this section.</span>
<span id="cb11-219"><a href="#cb11-219" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!----&gt;</span></span>
<span id="cb11-220"><a href="#cb11-220" aria-hidden="true" tabindex="-1"></a><span class="fu">### Declaring imports used by functions and classes</span></span>
<span id="cb11-221"><a href="#cb11-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-222"><a href="#cb11-222" aria-hidden="true" tabindex="-1"></a>marimo can serialize functions and classes into the top-level of a file, so you can import them with regular Python syntax:</span>
<span id="cb11-223"><a href="#cb11-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-224"><a href="#cb11-224" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb11-225"><a href="#cb11-225" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> my_notebook <span class="im">import</span> my_function</span>
<span id="cb11-226"><a href="#cb11-226" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-227"><a href="#cb11-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-228"><a href="#cb11-228" aria-hidden="true" tabindex="-1"></a>In particular, if a cell defines just a single function or class, and if that function or class is pure</span>
<span id="cb11-229"><a href="#cb11-229" aria-hidden="true" tabindex="-1"></a>save for references to variables defined in a special **setup cell**, it will be serialized top-level.</span>
<span id="cb11-230"><a href="#cb11-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-231"><a href="#cb11-231" aria-hidden="true" tabindex="-1"></a>**Setup cell.** Notebooks can optionally include a setup cell that imports modules,</span>
<span id="cb11-232"><a href="#cb11-232" aria-hidden="true" tabindex="-1"></a>written in the file as:</span>
<span id="cb11-233"><a href="#cb11-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-234"><a href="#cb11-234" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- note this setup cell is hardcoded in the playground example --&gt;</span></span>
<span id="cb11-235"><a href="#cb11-235" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb11-236"><a href="#cb11-236" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> app.setup:</span>
<span id="cb11-237"><a href="#cb11-237" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> marimo <span class="im">as</span> mo</span>
<span id="cb11-238"><a href="#cb11-238" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> dataclasses</span>
<span id="cb11-239"><a href="#cb11-239" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-240"><a href="#cb11-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-241"><a href="#cb11-241" aria-hidden="true" tabindex="-1"></a>Modules imported in a setup cell can be used in "top-level" functions or</span>
<span id="cb11-242"><a href="#cb11-242" aria-hidden="true" tabindex="-1"></a>classes. You can add the setup cell from the general menu of the editor under:</span>
<span id="cb11-243"><a href="#cb11-243" aria-hidden="true" tabindex="-1"></a>:<span class="sc">:lucide:</span>diamond-plus:: Add setup cell.</span>
<span id="cb11-244"><a href="#cb11-244" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!----&gt;</span></span>
<span id="cb11-245"><a href="#cb11-245" aria-hidden="true" tabindex="-1"></a><span class="fu">### Functions and classes</span></span>
<span id="cb11-246"><a href="#cb11-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-247"><a href="#cb11-247" aria-hidden="true" tabindex="-1"></a>Notebook files expose functions and classes that depend only on variables defined in the setup cell (or on other such functions or classes). For example, the following cell:</span>
<span id="cb11-248"><a href="#cb11-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-249"><a href="#cb11-249" aria-hidden="true" tabindex="-1"></a><span class="in">```python {.marimo name="*roll_die"}</span></span>
<span id="cb11-250"><a href="#cb11-250" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> roll_die():</span>
<span id="cb11-251"><a href="#cb11-251" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb11-252"><a href="#cb11-252" aria-hidden="true" tabindex="-1"></a><span class="co">    A reusable function.</span></span>
<span id="cb11-253"><a href="#cb11-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-254"><a href="#cb11-254" aria-hidden="true" tabindex="-1"></a><span class="co">    Notice the indicator in the bottom right of the cell.</span></span>
<span id="cb11-255"><a href="#cb11-255" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb11-256"><a href="#cb11-256" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> random.randint(<span class="dv">1</span>, <span class="dv">7</span>)</span>
<span id="cb11-257"><a href="#cb11-257" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-258"><a href="#cb11-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-259"><a href="#cb11-259" aria-hidden="true" tabindex="-1"></a>... is saved in the notebook file as</span>
<span id="cb11-260"><a href="#cb11-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-261"><a href="#cb11-261" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb11-262"><a href="#cb11-262" aria-hidden="true" tabindex="-1"></a><span class="at">@app.function</span></span>
<span id="cb11-263"><a href="#cb11-263" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> roll_die():</span>
<span id="cb11-264"><a href="#cb11-264" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''</span></span>
<span id="cb11-265"><a href="#cb11-265" aria-hidden="true" tabindex="-1"></a><span class="co">    A reusable function.</span></span>
<span id="cb11-266"><a href="#cb11-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-267"><a href="#cb11-267" aria-hidden="true" tabindex="-1"></a><span class="co">    Notice the indicator in the bottom right of the cell.</span></span>
<span id="cb11-268"><a href="#cb11-268" aria-hidden="true" tabindex="-1"></a><span class="co">    '''</span></span>
<span id="cb11-269"><a href="#cb11-269" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> random.randint(<span class="dv">1</span>, <span class="dv">7</span>)</span>
<span id="cb11-270"><a href="#cb11-270" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-271"><a href="#cb11-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-272"><a href="#cb11-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-273"><a href="#cb11-273" aria-hidden="true" tabindex="-1"></a>Making it importable as</span>
<span id="cb11-274"><a href="#cb11-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-275"><a href="#cb11-275" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb11-276"><a href="#cb11-276" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> my_notebook <span class="im">import</span> roll_die</span>
<span id="cb11-277"><a href="#cb11-277" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-278"><a href="#cb11-278" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!----&gt;</span></span>
<span id="cb11-279"><a href="#cb11-279" aria-hidden="true" tabindex="-1"></a>Standalone classes are also exposed:</span>
<span id="cb11-280"><a href="#cb11-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-281"><a href="#cb11-281" aria-hidden="true" tabindex="-1"></a><span class="in">```python {.marimo name="*SimulationExample"}</span></span>
<span id="cb11-282"><a href="#cb11-282" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclasses.dataclass</span></span>
<span id="cb11-283"><a href="#cb11-283" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SimulationExample:</span>
<span id="cb11-284"><a href="#cb11-284" aria-hidden="true" tabindex="-1"></a>    n_rolls: <span class="bu">int</span></span>
<span id="cb11-285"><a href="#cb11-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-286"><a href="#cb11-286" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> simulate(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">list</span>[<span class="bu">int</span>]:</span>
<span id="cb11-287"><a href="#cb11-287" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [roll_die() <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.n_rolls)]</span>
<span id="cb11-288"><a href="#cb11-288" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-289"><a href="#cb11-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-290"><a href="#cb11-290" aria-hidden="true" tabindex="-1"></a>This class is saved in the file as</span>
<span id="cb11-291"><a href="#cb11-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-292"><a href="#cb11-292" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb11-293"><a href="#cb11-293" aria-hidden="true" tabindex="-1"></a><span class="at">@app.class_definition</span></span>
<span id="cb11-294"><a href="#cb11-294" aria-hidden="true" tabindex="-1"></a><span class="at">@dataclasses.dataclass</span></span>
<span id="cb11-295"><a href="#cb11-295" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SimulationExample:</span>
<span id="cb11-296"><a href="#cb11-296" aria-hidden="true" tabindex="-1"></a>    n_rolls: <span class="bu">int</span></span>
<span id="cb11-297"><a href="#cb11-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-298"><a href="#cb11-298" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> simulate(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">list</span>[<span class="bu">int</span>]:</span>
<span id="cb11-299"><a href="#cb11-299" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [roll_die() <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.n_rolls)]</span>
<span id="cb11-300"><a href="#cb11-300" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-301"><a href="#cb11-301" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!----&gt;</span></span>
<span id="cb11-302"><a href="#cb11-302" aria-hidden="true" tabindex="-1"></a>/// attention | Heads up</span>
<span id="cb11-303"><a href="#cb11-303" aria-hidden="true" tabindex="-1"></a>///</span>
<span id="cb11-304"><a href="#cb11-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-305"><a href="#cb11-305" aria-hidden="true" tabindex="-1"></a>Not all standalone functions will be exposed in the module. If your</span>
<span id="cb11-306"><a href="#cb11-306" aria-hidden="true" tabindex="-1"></a>function depends on variables that are defined in other cells, then it won't</span>
<span id="cb11-307"><a href="#cb11-307" aria-hidden="true" tabindex="-1"></a>be exposed top-level.</span>
<span id="cb11-308"><a href="#cb11-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-309"><a href="#cb11-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-310"><a href="#cb11-310" aria-hidden="true" tabindex="-1"></a>For example, this function will not be exposed:</span>
<span id="cb11-311"><a href="#cb11-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-312"><a href="#cb11-312" aria-hidden="true" tabindex="-1"></a><span class="in">```python {.marimo}</span></span>
<span id="cb11-313"><a href="#cb11-313" aria-hidden="true" tabindex="-1"></a>variable <span class="op">=</span> <span class="dv">123</span></span>
<span id="cb11-314"><a href="#cb11-314" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-315"><a href="#cb11-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-316"><a href="#cb11-316" aria-hidden="true" tabindex="-1"></a><span class="in">```python {.marimo name="wrapped_function_example"}</span></span>
<span id="cb11-317"><a href="#cb11-317" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> not_a_top_level_function():</span>
<span id="cb11-318"><a href="#cb11-318" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb11-319"><a href="#cb11-319" aria-hidden="true" tabindex="-1"></a><span class="co">    This function depends on a variable declared in another cell.</span></span>
<span id="cb11-320"><a href="#cb11-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-321"><a href="#cb11-321" aria-hidden="true" tabindex="-1"></a><span class="co">    As a result this function isn't exposed in the file ‚Äî and the tooltip in the</span></span>
<span id="cb11-322"><a href="#cb11-322" aria-hidden="true" tabindex="-1"></a><span class="co">    bottom-right corner indicates this.</span></span>
<span id="cb11-323"><a href="#cb11-323" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb11-324"><a href="#cb11-324" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> variable</span>
<span id="cb11-325"><a href="#cb11-325" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-326"><a href="#cb11-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-327"><a href="#cb11-327" aria-hidden="true" tabindex="-1"></a><span class="fu">## FAQ</span></span>
<span id="cb11-328"><a href="#cb11-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-329"><a href="#cb11-329" aria-hidden="true" tabindex="-1"></a><span class="fu">### I want to edit notebooks in a different editor, what do I need to know?</span></span>
<span id="cb11-330"><a href="#cb11-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-331"><a href="#cb11-331" aria-hidden="true" tabindex="-1"></a>See the docs on <span class="co">[</span><span class="ot">using your own editor</span><span class="co">](https://docs.marimo.io/guides/editor_features/watching/)</span>.</span>
<span id="cb11-332"><a href="#cb11-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-333"><a href="#cb11-333" aria-hidden="true" tabindex="-1"></a><span class="fu">### I want to import functions from a marimo notebook, what do I need to know?</span></span>
<span id="cb11-334"><a href="#cb11-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-335"><a href="#cb11-335" aria-hidden="true" tabindex="-1"></a>See the docs on [reusable functions and</span>
<span id="cb11-336"><a href="#cb11-336" aria-hidden="true" tabindex="-1"></a>classes](https://links.marimo.app/reusable-functions).</span>
<span id="cb11-337"><a href="#cb11-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-338"><a href="#cb11-338" aria-hidden="true" tabindex="-1"></a><span class="fu">### I want to run pytest on marimo notebooks, what do I need to know?</span></span>
<span id="cb11-339"><a href="#cb11-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-340"><a href="#cb11-340" aria-hidden="true" tabindex="-1"></a>See the docs on <span class="co">[</span><span class="ot">testing</span><span class="co">](https://docs.marimo.io/guides/testing/)</span>.</span>
<span id="cb11-341"><a href="#cb11-341" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!----&gt;</span></span>
<span id="cb11-342"><a href="#cb11-342" aria-hidden="true" tabindex="-1"></a><span class="fu">## This notebook's source code</span></span>
<span id="cb11-343"><a href="#cb11-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-344"><a href="#cb11-344" aria-hidden="true" tabindex="-1"></a>The source code of this notebook is shown below:</span>
<span id="cb11-345"><a href="#cb11-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-346"><a href="#cb11-346" aria-hidden="true" tabindex="-1"></a><span class="in">```python {.marimo}</span></span>
<span id="cb11-347"><a href="#cb11-347" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="va">__file__</span>, <span class="st">"r"</span>, encoding<span class="op">=</span><span class="st">"utf-8"</span>) <span class="im">as</span> f:</span>
<span id="cb11-348"><a href="#cb11-348" aria-hidden="true" tabindex="-1"></a>    contents <span class="op">=</span> f.read()</span>
<span id="cb11-349"><a href="#cb11-349" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-350"><a href="#cb11-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-351"><a href="#cb11-351" aria-hidden="true" tabindex="-1"></a><span class="in">```python {.marimo}</span></span>
<span id="cb11-352"><a href="#cb11-352" aria-hidden="true" tabindex="-1"></a>mo.ui.code_editor(contents)</span>
<span id="cb11-353"><a href="#cb11-353" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>